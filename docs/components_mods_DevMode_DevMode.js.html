<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>GEngien3D API Documentation</title>
    
    <meta name="description" content="Documentation for GEngien3D library" />
    
        <meta name="keywords" content="docs, documentation, three.js, three.js event system, GEngien3D, renderer, html5, javascript, jsdoc" />
        <meta name="keyword" content="docs, documentation, three.js, three.js event system, GEngien3D, renderer, html5, javascript, jsdoc" />
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Libre+Franklin:400,700" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/main.css">

    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true},"applicationName":"GEngien3D","footer":"Made with ♥ by PuhDWL","copyright":"GEngien3D Copyright © 2020 PuhDWL.","disqus":"","googleAnalytics":"UA-103772589-5","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"GEngien3D API Documentation","description":"Documentation for GEngien3D library","keyword":"docs, documentation, three.js, three.js event system, GEngien3D, renderer, html5, javascript, jsdoc"},"linenums":true};
    </script>
    

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', config.googleAnalytics]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">GEngien3D</a></h3>
    <button id="menuToggle" class="btn btn-link btn-lg menu-toggle">
        <span class="glyphicon glyphicon-menu-hamburger"></span>
    </button>
    <div class="search">
        <input id="search" type="text" class="form-control input-md" placeholder="Search...">
    </div>
    <ul class="list">
    
    
        <li class="item" data-name="global">
            <span class="title namespace ">
                
                <span class="namespaceTag">
                    <span class="glyphicon glyphicon-globe"></span>
                </span>
                
                
                    <a href="global.html">Global</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li class="parent  " data-name="addEventCustomListener"><a href="global.html#addEventCustomListener">addEventCustomListener</a></li>
            
                <li class="parent  " data-name="allUnselected"><a href="global.html#allUnselected">allUnselected</a></li>
            
                <li class="parent  " data-name="checkRequiredProperty"><a href="global.html#checkRequiredProperty">checkRequiredProperty</a></li>
            
                <li class="parent  " data-name="clearFolderWithField"><a href="global.html#clearFolderWithField">clearFolderWithField</a></li>
            
                <li class="parent  " data-name="searchElement"><a href="global.html#searchElement">searchElement</a></li>
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="AbstractObject">
            <span class="title  ">
                
                
                    <a href="AbstractObject.html">AbstractObject</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="AmbientLight">
            <span class="title  ">
                
                
                    <a href="AmbientLight.html">AmbientLight</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Box">
            <span class="title  ">
                
                
                    <a href="Box.html">Box</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Camera">
            <span class="title  ">
                
                
                    <a href="Camera.html">Camera</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Canvas">
            <span class="title  ">
                
                
                    <a href="Canvas.html">Canvas</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Cylinder">
            <span class="title  ">
                
                
                    <a href="Cylinder.html">Cylinder</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="DirectionalLight">
            <span class="title  ">
                
                
                    <a href="DirectionalLight.html">DirectionalLight</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="GLTF">
            <span class="title  ">
                
                
                    <a href="GLTF.html">GLTF</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Light">
            <span class="title  ">
                
                
                    <a href="Light.html">Light</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Line">
            <span class="title  ">
                
                
                    <a href="Line.html">Line</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="module.exports">
            <span class="title  ">
                
                
                    <a href="module.html#.exports">module.exports</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="OrbitControl">
            <span class="title  ">
                
                
                    <a href="OrbitControl.html">OrbitControl</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Plane">
            <span class="title  ">
                
                
                    <a href="Plane.html">Plane</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="PointLight">
            <span class="title  ">
                
                
                    <a href="PointLight.html">PointLight</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Ring">
            <span class="title  ">
                
                
                    <a href="Ring.html">Ring</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Sky">
            <span class="title  ">
                
                
                    <a href="Sky.html">Sky</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="Sphere">
            <span class="title  ">
                
                
                    <a href="Sphere.html">Sphere</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
        <li class="item" data-name="SpotLight">
            <span class="title  ">
                
                
                    <a href="SpotLight.html">SpotLight</a>
                
            </span>
            
            <ul class="members itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="typedefs itemMembers">
            
            </ul>
            
            <ul class="methods itemMembers">
            
            </ul>
            
            <ul class="events itemMembers">
            
            </ul>
            
        </li>
    
    </ul>
</div>

    <div class="main">
        <h1 class="page-title" data-filename="components_mods_DevMode_DevMode.js.html">Source: components/mods/DevMode/DevMode.js</h1>
        


    
    <section>
        <header>
            <div class="header content-size">
                <h2>components/mods/DevMode/DevMode.js</h2>
            </div>
        </header>
        <article>
            <pre id="source-code" class="prettyprint source linenums"><code>import React from "react";
import { AbstractObject } from "../../../index";
import GUI from './GenerateGUI'
import CONST from '../../../constants'
import { v4 } from 'uuid'
import {
  HELP_FUELDER_FOR_GEOMETRY,
  HELP_INFO_FIELD_FOR_CAMERA,
  HELP_TYPE_RANGE,
  HELP_CHANGE_INFO_FIELD,
  HELP_CHANGE_CAMERA_FIELD,
} from './GenerateGUI/helpInfoField'
import { changeValueGeometry } from './changeMethodGeometry';
import { searchElement, allUnselected, clearFolderWithField } from './methodForDevMode'
import defaultState from './defaultState'
import { TextureLoader, RepeatWrapping, MeshBasicMaterial } from 'three'

class DevMode extends AbstractObject {
  constructor(props) {
    super(props);
    this.state = {
      ...defaultState
    }
  }


  /**
     * получает геометрию и материалы
     * @param uuid
     */
  getMaterialAndGeometry = (uuid) => {
    const { requiredPropertys } = this.props
    let obj = requiredPropertys.scene.getObjectByProperty("uuid", uuid);
    if (obj.material &amp;&amp; Array.isArray(obj.material)) {
      obj &amp;&amp; obj.material &amp;&amp; obj.geometry &amp;&amp;
        this.changeState({
          materials: null,
          arrayMaterials: obj.material,
          typeGeometry: obj.geometry.type
        })
      this.sceneObjectToDevPanel(this.state.selectId)
    } else {
      obj &amp;&amp; obj.material &amp;&amp; obj.geometry &amp;&amp;
        this.changeState({
          materials: obj.material,
          typeGeometry: obj.geometry.type,
          arrayMaterials: null
        })
      this.sceneObjectToDevPanel(this.state.selectId)
    }

  }

  /**
    *  изменение глубины поиска обьектов со сцены
    * @param value
    */
  changeRecurseDeapth = (value) => {
    this.changeState({
      deapthRecurse: value
    })
  }

  //! добавление/создание папок и полей

  /**
      * добавляет поле в стейт к выбранному родителю
      * @param params
      * @param idParent
      * @param state
      */
  addField = (params = {}, idParent = null, state) => {
    let newState = state
    const { name, ...props } = params
    /**
   * рекурсивный поиск родителя по стейту 
   * @param node
   */
    const recurseCheckParent = (node) => {
      node.map((item) => {
        if (item.id === idParent) {
          item.children.push({
            name: name,
            ...props
          })
        } else {
          if (item.children &amp;&amp; item.children.length) {
            recurseCheckParent(item.children)
          }
          return item
        }
      })
    }
    recurseCheckParent(newState)
    this.changeState({
      nodes: newState,
    })
  }

  /**
    * добавляет папку в стейт к выбранному родителю
    * @param params
    * @param idParent
    * @param state
    */
  addFolder = (params = {}, idParent = null, state) => {
    let newId = idParent ? idParent : v4()
    let newState = state
    /**
   * рекурсивный поиск родителя по стейту
   * @param node
   */
    const recurseCheckParent = (node) => {
      if (node &amp;&amp; node.length &amp;&amp; idParent) {
        let newFolder = node.map((item) => {
          if (item.id === idParent) {
            if ((!params.name &amp;&amp; !params.name.length) || (!item.name &amp;&amp; !item.name.length)) {
              item.name = 'no name'
            }
            item.children.push({
              ...params
            })
            return newId = params.id
          } else {
            if (item.children &amp;&amp; item.children.length) {
              recurseCheckParent(item.children)
            }
            return item
          }
        })
        return newFolder
      } else {
        node.push({
          name: params.name,
          id: newId,
          isOpen: params.isOpen,
          isSelect: params.isSelect,
          children: params.children,
          type: 'folder'
        })
      }
    }
    recurseCheckParent(newState)
    this.changeState({
      nodes: newState,
    })
    return newId
  }

  /**
    * создание полей по типу поля
    * @param obj
    * @param property
    * @param idParent
    * @param type
    */
  addFieldBySwitchType = (obj, property, idParent, type) => {
    const { nodes } = this.state
    switch (type) {
      case 'boolean':
        this.addField({
          name: property,
          id: v4(),
          readOnly: false,
          type: 'field',
          change: this.changeValueInputInState,
          typeField: 'boolean',
          value: obj[property],
        }, idParent, nodes)
        break;

      case 'file':
        this.addField({
          name: property,
          id: v4(),
          readOnly: false,
          type: 'field',
          change: this.changeInputMapForMaterial,
          typeField: 'file',
          value: obj[property],
        }, idParent, nodes)
        break;

      case 'range':
        this.addField({
          name: property,
          id: v4(),
          readOnly: false,
          type: 'field',
          change: this.changeValueInputInState,
          typeField: 'range',
          value: obj[property],
        }, idParent, nodes)
        break;

      case 'number':
        this.addField({
          name: property,
          id: v4(),
          readOnly: false,
          type: 'field',
          down: this.changeValueInput,
          change: this.changeValueInputInState,
          typeField: 'number',
          value: obj[property],
        }, idParent, nodes)
        break;

      case 'string':
        this.addField({
          name: property,
          id: v4(),
          readOnly: false,
          type: 'field',
          change: this.changeValueInputInState,
          typeField: 'string',
          value: obj[property],
        }, idParent, nodes)
        break;

      case 'button':
        this.addField({
          name: property,
          value: '#fff',
          readOnly: false,
          id: v4(),
          change: this.changeValueInputInState,
          typeField: 'button',
          type: 'field',
        }, idParent, nodes)
        break;
      case 'object':
        return
      default:
        return
    }
  }

  /**
       * создает папки объектов со сцены
       * @param scene
       */
  createObjectSceneFolder = (scene) => {
    let counterDeapth = 0;
    /**
     * рекурсивно проходит по сцене до указанной глубины
     * @param scene
     * @param parentId
     */
    const recurseCheckScene = (scene, parentId) => {
      if (!Array.isArray(scene)) {
        this.addFolder({
          name: scene.name,
          id: scene.uuid,
          isOpen: false,
          isSelect: false,
          type: 'folder',
          selectObj: () => this.selectObject(scene.uuid),
          children: [],
        }, parentId, this.state.nodes)
        if (scene.children &amp;&amp; scene.children.length) {
          recurseCheckScene(scene.children, scene.uuid)
        }
      } else {
        if (counterDeapth &lt; this.state.deapthRecurse) {
          scene.forEach(item => {
            this.addFolder({
              name: item.name,
              id: item.uuid,
              isOpen: false,
              isSelect: false,
              type: 'folder',
              selectObj: () => this.selectObject(item.uuid),
              children: [],
            }, parentId, this.state.nodes)
            if (item.children &amp;&amp; item.children.length) {
              counterDeapth = counterDeapth + 1;
              recurseCheckScene(item.children, item.uuid)
            }
          })
        } else {
          counterDeapth = 0;
          return false
        }
      }
    }
    recurseCheckScene(scene, this.state.idObjectScene)
  }

  //! Камера

  /**
    * создание папок и полей камеры
    */
  createCameraFolder = () => {
    const { idCamera, nodes } = this.state;
    const { requiredPropertys } = this.props;
    const obj = requiredPropertys.scene.getObjectByProperty("name", CONST.DATA_OBJECT_SCENE.MAIN_CAMERA.name);
    const createFieldForCamera = (obj, property, idParent) => {
      for (let key in obj) {
        if (HELP_INFO_FIELD_FOR_CAMERA[property][key]) {
          this.addField({
            name: HELP_INFO_FIELD_FOR_CAMERA[property][key],
            value: obj[key],
            readOnly: false,
            id: v4(),
            change: this.changeValueInputInState,
            down: this.changeValueInput,
            typeField: typeof obj[key],
            type: 'field',
          }, idParent, nodes)
        }
      }
    }
    const fieldForCamera = (objCamera) => {
      for (let key in objCamera) {
        if (HELP_INFO_FIELD_FOR_CAMERA[key]) {
          if (typeof objCamera[key] === 'object') {
            switch (key) {
              case 'position':
                createFieldForCamera(objCamera[key], key, idPosition)
                break;
              case 'quaternion':
                createFieldForCamera(objCamera[key], key, idQuaternion)
                break
              case 'rotation':
                createFieldForCamera(objCamera[key], key, idRotation)
                break
              case 'scale':
                createFieldForCamera(objCamera[key], key, idScale)
                break;
            }
          } else {
            this.addFieldBySwitchType(objCamera, key, idCamera, typeof objCamera[key])
          }
        }
      }
    }

    const idPosition = this.addFolder(
      {
        name: 'Позиция',
        id: v4(),
        type: 'folder',
        isOpen: false,
        selectObj: () => { },
        isSelect: false,
        children: [],
      },
      this.state.idCamera,
      this.state.nodes)
    const idQuaternion = this.addFolder(
      {
        name: 'Кватернион',
        id: v4(),
        type: 'folder',
        isOpen: false,
        isSelect: false,
        selectObj: () => { },
        children: []
      },
      this.state.idCamera,
      this.state.nodes)
    const idRotation = this.addFolder(
      {
        name: 'Вращение',
        id: v4(),
        type: 'folder',
        isOpen: false,
        isSelect: false,
        selectObj: () => { },
        children: []
      },
      this.state.idCamera,
      this.state.nodes)
    const idScale = this.addFolder(
      {
        name: 'Шкала',
        id: v4(),
        type: 'folder',
        isOpen: false,
        isSelect: false,
        selectObj: () => { },
        children: []
      },
      this.state.idCamera,
      this.state.nodes)

    this.changeState({
      idFolderForCamera: {
        idPosition: idPosition,
        idQuaternion: idQuaternion,
        idRotation: idRotation,
        idScale: idScale
      },
      cameraObj: obj
    }, () => {
      fieldForCamera(obj)
    })
  }

  /**
    * изменение полей камеры
    * @param name
    * @param value
    */
  changeCamera = (name, value) => {
    let { cameraObj } = this.state
    HELP_CHANGE_CAMERA_FIELD[name](cameraObj, value)
  }

  //! информация о выбранном обьекте
  /**
     * изменение полей информации об объекте
     * @param name
     * @param value
     */
  changeInfoObject = (name, value) => {
    let { currentObject } = this.state
    HELP_CHANGE_INFO_FIELD[name](currentObject, value)
  }

  /**
       * создает поля и папки информации выбранного обьекта
       * @param selectObj
       * TODO: изменить метод создания полей
       */
  infoElement = (selectObj) => {
    const { idObject, nodes } = this.state
    /**
     * создание полей для папок в информации об объекте
     * @param obj
     * @param property
     * @param idParent
     */
    const createFieldForInfo = (obj, property, idParent) => {
      for (let key in obj) {
        if (HELP_INFO_FIELD_FOR_CAMERA[property][key]) {
          this.addField({
            name: HELP_INFO_FIELD_FOR_CAMERA[property][key],
            value: obj[key],
            readOnly: false,
            id: v4(),
            change: this.changeValueInputInState,
            down: this.changeValueInput,
            typeField: typeof obj[key],
            type: 'field',
          }, idParent, nodes)
        }
      }
    }
    /**
     * проверяет на наличие обьектов
     *
     */
    const checkObject = () => {
      for (let key in selectObj) {
        if (selectObj.hasOwnProperty(key)) {
          if (HELP_INFO_FIELD_FOR_CAMERA[key]) {
            if (typeof selectObj[key] === 'object') {
              switch (key) {
                case 'position':
                  createFieldForInfo(selectObj[key], key, idPosition)
                  break;
                case 'quaternion':
                  createFieldForInfo(selectObj[key], key, idQuaternion)
                  break
                case 'rotation':
                  createFieldForInfo(selectObj[key], key, idRotation)
                  break
                case 'scale':
                  createFieldForInfo(selectObj[key], key, idScale)
                  break;
              }
            } else {
              this.addFieldBySwitchType(selectObj, key, idObject, typeof selectObj[key])
            }
          }
        }
      }
    }
    const idPosition = this.addFolder({
      name: 'Позиция',
      id: v4(),
      type: 'folder',
      isOpen: false,
      selectObj: () => { },
      isSelect: false,
      children: [],
    },
      idObject,
      nodes)
    const idQuaternion = this.addFolder({
      name: 'Кватернион',
      id: v4(),
      type: 'folder',
      isOpen: false,
      selectObj: () => { },
      isSelect: false,
      children: [],
    },
      idObject,
      nodes)
    const idRotation = this.addFolder({
      name: 'Вращение',
      id: v4(),
      type: 'folder',
      isOpen: false,
      selectObj: () => { },
      isSelect: false,
      children: [],
    },
      idObject,
      nodes)
    const idScale = this.addFolder({
      name: 'Шкала',
      id: v4(),
      type: 'folder',
      isOpen: false,
      selectObj: () => { },
      isSelect: false,
      children: [],
    },
      idObject,
      nodes)


    this.changeState({
      idFolderInfo: {
        idPosition: idPosition,
        idQuaternion: idQuaternion,
        idRotation: idRotation,
        idScale: idScale,
      }
    }, () => {
      checkObject()
    })
  }

  /**
    *  Получает и отменяет выбранный обьект
    * @param uuid
    */
  sceneObjectToDevPanel = (uuid) => {
    const { selectId } = this.state
    const { requiredPropertys } = this.props
    let obj = requiredPropertys.scene.getObjectByProperty("uuid", uuid);
    if (selectId === null) {
      this.changeState({
        nodes: clearFolderWithField(this.state),
        currentObject: null,
        arrayMaterials: null,
      })
    } else {
      this.changeState({
        nodes: clearFolderWithField(this.state),
        currentObject: obj,
      }, () => {
        this.infoElement(obj)
        this.materialElement(obj)
        this.geometryElement(obj)
      })
    }
  }

  //! изменение занчений полей

  changeInputMapForMaterial = (e) => {
    const { currentObject, materials, arrayMaterials } = this.state
    let map = new TextureLoader().load(e.target.value);
    map.wrapS = RepeatWrapping;
    map.wrapT = RepeatWrapping;
    map.repeat.set(1, 1);
    let material = new MeshBasicMaterial({
      map: map,
    });
    material.needsUpdate = true;
    if (arrayMaterials) {
      const newMaterial = currentObject.material.map(item => {
        if (item.uuid === materials.uuid) {
          return item = material;
        } else {
          return item
        }
      })
      currentObject.material = newMaterial
    } else {
      currentObject.material = material;
    }
  }

  /**
     * изменение полей
     * @param newValue
     * @param id
     */
  changeValueInputInState = (newValue, id) => {
    const { idGeometry, idMaterial, idCamera, idObject, nodes } = this.state
    let parent = null;
    let nameField = null;
    let valueField = newValue;
    let isChecked = false;
    /**
    * Определение родителя верхнего уровня выбранного обьекта
    * @param el
    */
    const setParent = (el) => {
      const { idMaterial, idCamera, idGeometry, idObject } = this.state
      switch (el.id) {
        case idMaterial:
          parent = el
          break;
        case idCamera:
          parent = el
          break
        case idGeometry:
          parent = el
          break
        case idObject:
          parent = el
          break
      }
    }
    /**
    * ищем поле у когорого нужно поменять значение
    * @param node
    */
    const searchIdField = (node) => {
      let newSelected = node.map(el => {
        if (el.id === id) {
          isChecked = true
          nameField = el.name
          return (
            {
              ...el,
              value: newValue
            }
          )
        } else {
          if (el.children &amp;&amp; el.children.length) {
            if (!isChecked) {
              setParent(el)
            }
            let newItem = el
            let newChild = searchIdField(el.children)
            newItem.children = newChild
            return newItem
          }
          return el
        }
      })
      return newSelected
    }
    const newValueInput = searchIdField(nodes)
    this.setState({
      nodes: newValueInput
    }, () => {
      switch (parent.id) {
        case idObject:
          this.changeInfoObject(nameField, valueField)
          break;

        case idMaterial:
          this.changeMaterialContextObject(nameField, valueField)
          break

        case idGeometry:
          this.changeGeometryContextObject(nameField, valueField)
          break

        case idCamera:
          this.changeCamera(nameField, valueField)
          break
      }

    })
  }

  /**
     * изменение значения поля тип number зажатием ПКМ и перемещением мышки
     * @param e
     * @param id
     */
  changeValueInput = (e, id) => {
    e.persist()
    let valueInputTarget = e.currentTarget.value
    let positionElementTarget = e.currentTarget.getBoundingClientRect().top;
    const speedChangeValue = 1
    /**
    * очищает слушатели
    * 
    */
    const cancelChangeValue = () => {
      this.changeState({ mouseDown: false }, () => {
        window.removeEventListener("mousemove", (e) => changeValue(e, positionElementTarget, valueInputTarget))
        window.removeEventListener("mouseup", cancelChangeValue)

      })
    }
    /**
    * Проверяет и увеличивает/уменьшает значение
    * @param e
    * @param positionElement
    */
    const changeValue = (e, positionElement) => {
      if (this.state.mouseDown &amp;&amp; positionElement > e.clientY &amp;&amp; document.activeElement.id === id) {
        valueInputTarget = +valueInputTarget + speedChangeValue
        positionElementTarget = e.clientY
        this.changeValueInputInState(valueInputTarget, id)
      } else if (this.state.mouseDown &amp;&amp; positionElement &lt; e.clientY &amp;&amp; document.activeElement.id === id) {
        valueInputTarget = +valueInputTarget - speedChangeValue
        positionElementTarget = e.clientY
        this.changeValueInputInState(valueInputTarget, id)
      }
    }
    this.changeState({ mouseDown: true })
    window.addEventListener('mouseup', cancelChangeValue)
    window.addEventListener('mousemove', (e) => changeValue(e, positionElementTarget, valueInputTarget))
  }

  //! выбор, открытие, закрытие папок 

  /**
       * открывает папки
       * @param id
       */
  toggleDropDown = (id) => {
    const { nodes } = this.state
    const newState = searchElement(id, 'isOpen', nodes)
    this.changeState({
      nodes: newState
    })
  }

  /**
     * выделяет обьект
     * @param id
     */
  selectObject = (id) => {
    const { nodes, selectId } = this.state
    const closePrevFolder = allUnselected
    id !== selectId
      ?
      this.changeState({
        nodes: searchElement(
          id,
          'isSelect',
          closePrevFolder(nodes),
        ),
        selectId: id
      })
      :
      this.changeState({
        nodes: searchElement(
          id,
          'isSelect',
          nodes,
        ),
        selectId: null
      })
  }

  //!Материалы
  /**
     * Очищает папку материалы при выборе другого материала
     * @param nodes
     * @param idMaterial
     */
  clearMaterialFolder = (nodes, idMaterial) => {
    return nodes.map(item => {
      if (item.id === idMaterial) {
        return {
          ...item,
          children: [item.children[0]]
        }
      }
      return item
    })
  }

  /**
     * Получение выбранного материала из массива
     * @param e
     */
  chooseMaterialFromList = (e) => {
    const { arrayMaterials, idMaterial, nodes } = this.state
    const indexOption = e.target.selectedIndex;
    const getElementOptionId = e.target.childNodes[indexOption].id;
    let chooseMaterial = arrayMaterials.filter(item => item.uuid === getElementOptionId)
    let newMaterial = this.clearMaterialFolder(nodes, idMaterial)
    this.changeState({
      nodes: newMaterial,
      materials: chooseMaterial[0],
    }, () => {
      this.parseFieldForMaterial(chooseMaterial[0], idMaterial, nodes)
    })
  }

  /**
     * cоздает поля для материалов и камеры
     * @param parseObj
     * @param idParent
     * @param state
     */
  parseFieldForMaterial = (parseObj, idParent, node) => {
    console.log('parseObj', parseObj)
    for (let key in parseObj) {
      if (parseObj.hasOwnProperty(key)) {
        switch (key) {
          case 'color':
            this.addFieldBySwitchType(parseObj, key, idParent, 'button')
            break;
          case 'map':
            this.addFieldBySwitchType(parseObj, key, idParent, 'file')
            break;
          default:
            this.addFieldBySwitchType(parseObj, key, idParent, typeof parseObj[key])
            break;
        }
      }
    }
  }

  /**
     * cоздает папку для выбора материала
     * @param idParent
     * @param state
     * @param listTypeMaterial
     */
  fieldChooseMaterial = (idParent, state, listTypeMaterial) => {
    this.addField({
      name: 'Выберите материал',
      id: v4(),
      value: listTypeMaterial,
      type: 'field',
      typeField: 'select',
      readOnly: false,
      change: this.chooseMaterialFromList
    }, idParent, state)
  }

  /**
     * проверка полей по объекту материалов
     * @param selectObj
     */
  materialElement = (selectObj) => {
    const { idMaterial, nodes, materials, arrayMaterials } = this.state;
    if (arrayMaterials) {
      let typeMaterialArr = arrayMaterials.map(item => {
        return {
          name: item.type,
          id: item.uuid
        }
      })
      this.fieldChooseMaterial(idMaterial, nodes, typeMaterialArr)
    }
    else {
      this.parseFieldForMaterial(materials, idMaterial, nodes)
    }

  }

  /**
 * изменение материалов объекта
 * @param name
 * @param value
 */
  changeMaterialContextObject = (name, value) => {
    const { currentObject, materials, arrayMaterials } = this.state
    if (arrayMaterials) {
      currentObject.material.filter(item => {
        if (item.uuid === materials.uuid) {
          console.log(item)
          switch (name) {
            case 'color':
              item[name].set(value)
              break;
            default:
              item[name] = +value
              break;
          }
        }
      })
    } else {
      switch (name) {
        case 'color':
          currentObject.material[name].set(value)
          break;
        default:
          currentObject.material[name] = +value
          break;
      }
    }
  }

  //! геометрия

  /**
  * определяет поля для геометрии
  * @param uuid
  */
  geometryElement = () => {
    const { typeGeometry, idGeometry } = this.state;
    for (let key in HELP_FUELDER_FOR_GEOMETRY[typeGeometry]) {
      this.addFieldBySwitchType(
        HELP_FUELDER_FOR_GEOMETRY[typeGeometry],
        key,
        idGeometry,
        typeof HELP_FUELDER_FOR_GEOMETRY[typeGeometry][key]
      )
    }
  }

  /**
  * изменяет геометрию обьекта
  * @param name
  * @param value
  */
  changeGeometryContextObject = (name, value) => {
    const { typeGeometry, currentObject } = this.state
    for (let key in HELP_FUELDER_FOR_GEOMETRY[typeGeometry]) {
      if (name === key) {
        changeValueGeometry(
          currentObject,
          HELP_FUELDER_FOR_GEOMETRY[typeGeometry],
          name,
          value
        )
      }
    }
  }

  /**
     * Инициализирует начальную структуру
     * @param state
     * @param reRender
     */
  initStructure = (state, reRender = false) => {
    if (reRender) {
      state = []
    }
    const idObjectScene = this.addFolder(
      {
        name: 'Объекты сцены',
        id: v4(),
        isOpen: false,
        isSelect: false,
        type: 'folder',
        selectObj: () => { },
        children: [],
      }, null, state
    )
    const idGeometry = this.addFolder(
      {
        name: 'Геометрия',
        id: v4(),
        isOpen: false,
        isSelect: false,
        type: 'folder',
        selectObj: () => { },
        children: [],
      }, null, state
    )
    const idMaterial = this.addFolder(
      {
        name: 'Материалы',
        id: v4(),
        isOpen: false,
        isSelect: false,
        type: 'folder',
        selectObj: () => { },
        children: [],
      }, null, state
    )
    const idCamera = this.addFolder(
      {
        name: 'Камера',
        id: v4(),
        isOpen: false,
        isSelect: false,
        type: 'folder',
        children: [],
        selectObj: () => { },
      }, null, state
    )
    const idObject = this.addFolder(
      {
        name: 'Объект',
        id: v4(),
        isOpen: false,
        isSelect: false,
        children: [],
        type: 'folder',
        selectObj: () => { },
      }, null, state
    )

    this.changeState({
      idObjectScene: idObjectScene,
      idGeometry: idGeometry,
      idMaterial: idMaterial,
      idCamera: idCamera,
      idObject: idObject,
    }, () => {
      this.createObjectSceneFolder(this.props.requiredPropertys.scene)
      this.createCameraFolder(this.props.requiredPropertys.scene)
    })
  }

  /**
     * Изменяет стейт 
     * @param params
     */
  changeState = (params = {}, callback = () => { }) => {
    this.setState({
      ...params
    }, callback)
  }

  componentDidUpdate(prevProps, prevState) {
    const { nodes } = this.state
    if (prevProps !== this.props) {
      this.initStructure(nodes, true)
    }
    if (prevState.selectId !== this.state.selectId) {
      this.getMaterialAndGeometry(this.state.selectId)
    }
    if (prevState.deapthRecurse !== this.state.deapthRecurse) {
      this.initStructure(nodes, true)
    }
  }

  componentDidMount() {
    const { nodes } = this.state
    this.initStructure(nodes)
  }

  render() {
    console.log(this.props.requiredPropertys.scene)
    return (
      &lt;>
        &lt;GUI
          scene={this.state}
          toggleDropDown={this.toggleDropDown}
          changeRecurseDeapth={this.changeRecurseDeapth}
        />
      &lt;/>
    )
  }
}

export default DevMode</code></pre>
        </article>
    </section>






        

        <footer class="content-size">
            <div class="footer">
                Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Fri Oct 23 2020 18:28:43 GMT+0300 (Москва, стандартное время)
            </div>
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/main.js"></script>


</body>
</html>
